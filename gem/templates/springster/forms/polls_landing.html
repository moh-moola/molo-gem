{% load forms_personalise_extras wagtailimages_tags wagtailcore_tags wagtailsettings_tags static gem_tags %}
{% get_settings %}
<div class="polls polls--homepage polls--call-to-action">
  <div class="polls__bubble-icon"></div>
  <div class="polls__container">
    <div class="heading heading__micro"><p>{% trans "Take a vote!" %}</p></div>
    <div class="heading heading__component"><h3>{{form_page.title}}</h3></div>
    {% if form_page.homepage_introduction %}
      <div class="heading heading__subheading">
        <p>{{form_page.homepage_introduction|smarttruncatechars:100|safe}}</p>
      </div>
    {% endif %}
    {% if form %}
      {% include "patterns/basics/forms/forms-modules/form.html" with formtype="poll" formtypeClass="polls" %}
    {% else %}
      <div class="polls">
        <p class="errors">{% trans 'You have already completed this poll' %}.</p>
        {% if request.path == "/" %}
          <a href="{% pageurl form_page %}success/" class="call-to-action__button call-to-action__button--primary">
            <span class="call-to-action__button-text call-to-action__button-text--primary">
              {% trans "Show Results" %}
            </span>
          </a>
        {% else %}
          <div class="call-to-action call-to-action--wide-back">
            <a href="{{request.site.root_page.specific.url}}" class="call-to-action__nav-item-text call-to-action__nav-item-text--left">
              {% trans "Back home" %}</a>
          </div>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
